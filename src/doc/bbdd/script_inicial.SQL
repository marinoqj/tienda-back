/*
Created: 29/05/2020
Modified: 29/05/2020
Model: tiendaweb
Database: MySQL 5.7
*/


-- Create tables section -------------------------------------------------

-- Table PRODUCTOS

CREATE TABLE `PRODUCTOS`
(
  `ID_PRODUCTO` Int NOT NULL AUTO_INCREMENT,
  `ID_CATEGORIA` Int,
  `NOMBRE` Varchar(200),
  `PRECIO` Double(4,2),
  PRIMARY KEY (`ID_PRODUCTO`)
)
;

-- Table SECCIONES

CREATE TABLE `SECCIONES`
(
  `ID_SECCION` Int NOT NULL AUTO_INCREMENT,
  `NOMBRE` Varchar(200),
  PRIMARY KEY (`ID_SECCION`)
)
;

-- Table CATEGORIAS

CREATE TABLE `CATEGORIAS`
(
  `ID_CATEGORIA` Int NOT NULL AUTO_INCREMENT,
  `ID_SECCION` Int,
  `NOMBRE` Varchar(200),
  PRIMARY KEY (`ID_CATEGORIA`)
)
;

-- Table PEDIDOS

CREATE TABLE `PEDIDOS`
(
  `ID_PEDIDO` Int NOT NULL AUTO_INCREMENT,
  `ID_CLIENTE` Int,
  `TOTAL` Double(4,2),
  `FECHA` Date,
  PRIMARY KEY (`ID_PEDIDO`)
)
;

-- Table DETALLES

CREATE TABLE `DETALLES`
(
  `ID_DETALLE` Int NOT NULL AUTO_INCREMENT,
  `ID_PRODUCTO` Int,
  `ID_PEDIDO` Int,
  `PRECIO` Double(4,2),
  `CANTIDAD` Int,
  PRIMARY KEY (`ID_DETALLE`)
)
;

-- Table CLIENTES

CREATE TABLE `CLIENTES`
(
  `ID_CLIENTE` Int NOT NULL AUTO_INCREMENT,
  `NOMBRE` Varchar(200),
  `APELLIDOS` Varchar(200),
  `TELEFONO` Varchar(9),
  `DNI` Varchar(9),
  PRIMARY KEY (`ID_CLIENTE`)
)
;

-- Create foreign keys (relationships) section ------------------------------------------------- 


ALTER TABLE `CATEGORIAS` ADD CONSTRAINT `FK_CATEGORIAS_SECCIONES` FOREIGN KEY (`ID_SECCION`) REFERENCES `SECCIONES` (`ID_SECCION`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `PRODUCTOS` ADD CONSTRAINT `FK_PRODUCTOS_CATEGORIAS` FOREIGN KEY (`ID_CATEGORIA`) REFERENCES `CATEGORIAS` (`ID_CATEGORIA`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `DETALLES` ADD CONSTRAINT `FK_DETALLES_PRODUCTOS` FOREIGN KEY (`ID_PRODUCTO`) REFERENCES `PRODUCTOS` (`ID_PRODUCTO`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `DETALLES` ADD CONSTRAINT `FK_DETALLES_PEDIDOS` FOREIGN KEY (`ID_PEDIDO`) REFERENCES `PEDIDOS` (`ID_PEDIDO`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `PEDIDOS` ADD CONSTRAINT `FK_PEDIDOS_CLIENTES` FOREIGN KEY (`ID_CLIENTE`) REFERENCES `CLIENTES` (`ID_CLIENTE`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


